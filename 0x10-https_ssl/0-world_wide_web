#!/usr/bin/env bash
# A script that will display information about subdomains, after configuring your domain zone so
# that the subdomain www points to your load-balancer IP (lb-01), and adding other subdomains.

function audit_subdomain {
  domain=$1
  subdomain=$2
  
  # get the DNS record for the subdomain
  record=$(dig +short $subdomain.$domain)
  
  # check if the record exists
  if [ -z "$record" ]; then
    echo "The subdomain $subdomain does not exist."
  else
    # determine the record type (A or CNAME)
    if echo $record | grep -q "CNAME"; then
      record_type="CNAME"
      destination=$(echo $record | awk '{print $NF}')
    else
      record_type="A"
      destination=$record
    fi
    
    echo "The subdomain $subdomain is a $record_type record and points to $destination."
  fi
}

domain=$1
subdomain=${2:-"www lb-01 web-01 web-02"}

for sub in $subdomain; do
  audit_subdomain $domain $sub
done
